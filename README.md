# CBB 752 Final Project Part 2: Text Mining

---
## Instructions

**Text Mining Analysis**: Conduct an extensive literature review and text mining analysis using at least 20 publications retrieved from PubMed on your prioritized genes (include PMIDs). Leverage a Large Language Model (LLM), such as GPT-4 or similar, to systematically extract frequent biological terms, key findings, and gene-disease associations. Identify correlations between specific terms within and across publications. Discuss the implications for disease based on these correlations. Compare your LLMassisted findings with protein function annotations from comprehensive databases such as UniProt or GeneCards. Highlight any consistencies or discrepancies identified in this comparative analysis and discuss their significance.

---
## Results from Part 1

We found the overlapping variants from each list of top variants generated by ANNOVAR and ENSEMBL VEP, and filtered out any non-protein-coding genes. Here is the final list below:

| Gene Symbol | Alternative Name |
|-------------|------------------|
| LARGE1      |                  |
| TAFA5       | FAM19A5          |
| SYN3        |                  |
| TBC1D22A    |                  |
| MYO18B      |                  |
| PACSIN2     |                  |
| SEZ6L       |                  |
| CELSR1      |                  |
| EFCAB6      |                  |
| CECR2       |                  |

we saved the list of genes in `prioritized_genes_from_part1.txt`

---

## Installation

### Prerequisites

- Python 3.6+
- Pip package manager

### Setup

1. Clone the repository:
```
git clone https://github.com/yl2342/cbb752-final-project-part2.git
cd cbb752-final-project-part2
```

2. Create a virtual environment and install the dependencies:
```
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

3. Create a `.env` file in the project directory to store your email and Google Gemini API key:
```
EMAIL=your_email_here
GEMINI_API_KEY=your_api_key_here
```
You can obtain a Gemini API key from [Google AI Studio](https://aistudio.google.com/u/1/apikey).

### Gemini Model
- [Gemini API documentation](https://ai.google.dev/gemini-api/docs)
- Gemini model:
  - Gemini 2.0 flash (Default)
    - model name: `gemini-2.0-flash`
    - Beware of the Free tier rate limit (should be enough for this project, generated prompt from 50 pmc fulltext articles is around 500,000 tokens)
      - RPM (requests per minute): 15
      - TPM (tokens per minute): 1,000,000
      - RPD (requests per day): 1500
    - Run time: ~ 1 minute
    

## Usage

The workflow consists of two main steps:

### 1. Search open access full text articles from PubMed Central
For each prioritized gene, we fetched n (5) full text articles (sort by relevance) from PubMed Central. We parse the full text articles and save them as JSON files in the `pmc_full_texts` directory.

```shell
python pmc_fulltext_fetcher.py -l prioritized_gene_from_part1.txt -n 5
```

This will:
- Search top 5 relevant open access PMC full text articles for each prioritized gene
- Save the results to `pmc_full_texts/<gene>_pmc_fulltext.json`. For each full text article retrieved, it contains the following fields:
  - pmcid
  - title
  - published_date
  - full_text

### 2. Analyze the Retrieved Literature with Gemini AI

Process all collected PMC publications for the prioritized genes to construct a prompt embeed with the part II instruction for Gemini AI to conduct a comprehensive analysis as required

```shell
python llm_mining.py 
# or 
python llm_mining.py -m gemini-2.0-flash
```

This will:
- Load all the PMC full text articles from `pmc_full_texts/`
- Generate a prompt embeed with the part II instruction
- Call the Gemini API to analyze the organized literature
- Save both the prompt and LLM response to files:
  - `prompts/fulltext_analysis_prompt.txt`
  - `llm_responses/part2_fulltext_mining_response.txt`


You can also use the `--check`/`-c` flag to just check the generated prompt and the estimated input tokens first without sending the API request, for sanity check. 

```shell
python llm_mining.py -c # Only generate and save prompt without calling the API (for sanity check)
```

--- 
## Output and results

### JSON Articles File
The PMC full text articles are saved as a JSON file with detailed metadata for each article:
- pmcid
- title
- published_date
- full_text

### Analysis Prompt
The prompt file contains the structured input to the language model, including all article full text and analysis instructions.

### Analysis Response
The response file contains the Gemini-generated analysis based on the generated prompt.

--- 

## File Structure

```
geneinsight/
├── llm_mining.py             # Gemini analysis script
├── pmc_fulltext_fetcher.py   # PMC full text fetcher script
├── .env                      # Environment variables (email and API key)
├── prioritized_genes_from_part1.txt # Prioritized genes from part 1
├── pmc_full_texts/         # Directory for stored PubMed results
│   └── <gene>_pmc_fulltext.json    # JSON files with article data
├── prompts/                  # Directory for generated prompts
│   └── fulltext_analysis_prompt.txt
└── llm_responses/            # Directory for analysis results
    └── part2_fulltext_mining_response.txt
```


---

## Results 
### Systematic Analysis of PMC Open Access Literature for Prioritized Genes

**Total Genes Analyzed:** 10
**Total Articles Analyzed:** 50

#### 1. Overall Summary

Based on the provided 50 full-text articles, a summary of the most frequent and important biological terms, key findings, and gene-disease associations is presented below.

*   **Key Biological Terms:** The most frequent terms relate to gene expression, protein function, cell differentiation, cell death (apoptosis and necrosis), signal transduction pathways, and tissue specificity. Specific processes like angiogenesis, neurogenesis, and water-deficit stress response are also prominent. Terms related to specific experimental techniques such as RNA-seq, qPCR, and immunohistochemistry are also common.

*   **Key Findings:** A significant number of articles focus on the design and application of synthetic promoters to control gene expression in plants, particularly in response to environmental stresses like water deficit (PMCID: 11123411). Another key finding is the identification of SYN3 as a potential therapeutic target for diabetic retinopathy, with a newly developed cyclic peptide showing promise in ameliorating retinal ganglion cell degeneration (PMCID: 11528515). Several articles also explore the role of specific genes in cancer progression, including the identification of novel mutations and their impact on cell proliferation, migration, and drug resistance.

*   **Gene-Disease Associations:** Several genes are linked to specific diseases. SYN3 is associated with retinal ganglion cell degeneration in diabetic retinopathy (PMCID: 11528515) and behavioral flexibility deficits (PMCID: 8431823). ERCC6 is linked to cerebro-oculo-facio-skeletal syndrome (COFS) (PMCID: 6625147). BRIP1 is associated with Fanconi anemia (PMCID: 6625147). Gαi1/3 is associated with diabetic retinal neurodegeneration (PMCID: 11528515). PSD95 is associated with Angelman syndrome (PMCID: 11528515). LARGE1 is associated with muscular dystrophy (PMCID: 6500046) and bladder cancer (PMCID: 3962717).

*   **Correlations Between Terms:** A strong correlation exists between water-deficit stress and the expression of specific genes in poplar leaves, leading to the development of synthetic promoters inducible by drought. There is also a correlation between BDNF signaling and RGC survival, with compounds enhancing BDNF signaling showing promise in treating diabetic retinopathy. In cancer research, there is a correlation between specific gene mutations (e.g., in SYN3) and altered cell proliferation and migration, as well as drug resistance.

*   **Implications for Disease:** The correlations identified have significant implications for disease. The development of water-deficit stress-inducible promoters could lead to crops more resistant to drought. The identification of compounds enhancing BDNF signaling could lead to new treatments for diabetic retinopathy. The identification of genes involved in cancer progression could lead to new therapeutic targets and diagnostic markers.

#### 2. Comparative Analysis with External Databases

A comparative analysis of the genes mentioned in the provided articles with information from external databases (UniProtKB, GeneCards, OMIM) is presented below.

*   **SYN3:**
    *   **UniProtKB:** Encodes synapsin III, a neuron-specific phosphoprotein associated with synaptic vesicles. Involved in regulating neurotransmitter release and neuronal development.
    *   **GeneCards:** Synapsin III is involved in the regulation of axonogenesis and synaptogenesis. Expression is primarily in the brain.
    *   **OMIM:** No direct entry for disease association.
    *   **Comparison:** The articles confirm the role of SYN3 in neuronal function, particularly in neurotransmitter release, which aligns with UniProtKB and GeneCards. The articles also link SYN3 to behavioral flexibility, which is not explicitly mentioned in UniProtKB or GeneCards but is consistent with its role in neuronal function.

*   **EFCAB6:**
    *   **UniProtKB:** Encodes EF-hand calcium-binding domain-containing protein 6. Function is not well defined, but it is thought to be involved in calcium-dependent signaling pathways.
    *   **GeneCards:** EFCAB6 is involved in calcium binding. Expressed in various tissues, including the brain.
    *   **OMIM:** No direct entry for disease association.
    *   **Comparison:** The articles link EFCAB6 to sex development and COFS syndrome, which is not explicitly mentioned in UniProtKB or GeneCards. However, the articles also confirm the role of EFCAB6 in calcium binding, which aligns with UniProtKB and GeneCards.

*   **LARGE1:**
    *   **UniProtKB:** Encodes a glycosyltransferase involved in the glycosylation of alpha-dystroglycan. Essential for the proper formation of the dystroglycan complex.
    *   **GeneCards:** LARGE1 is involved in muscular dystrophy.
    *   **OMIM:** Links mutations in LARGE1 to various forms of congenital muscular dystrophy.
    *   **Comparison:** The articles confirm the role of LARGE1 in glycosylation of alpha-dystroglycan and its association with muscular dystrophy, which aligns with UniProtKB, GeneCards, and OMIM. The articles also link LARGE1 to cancer, which is not explicitly mentioned in UniProtKB, GeneCards, or OMIM but is consistent with its role in cell signaling and growth.

*   **TBC1D22A:**
    *   **UniProtKB:** Encodes a protein containing a TBC domain, suggesting a role as a Rab GTPase-activating protein (GAP).
    *   **GeneCards:** TBC1D22A is involved in protein transport and membrane trafficking.
    *   **OMIM:** Links mutations in TBC1D22A to autosomal recessive intellectual disability.
    *   **Comparison:** The articles link TBC1D22A to epilepsy and cancer, which is not explicitly mentioned in UniProtKB, GeneCards, or OMIM but is consistent with its role in protein transport and membrane trafficking.

*   **CELSR1:**
    *   **UniProtKB:** Encodes a seven-transmembrane cadherin involved in cell adhesion and planar cell polarity.
    *   **GeneCards:** CELSR1 is involved in neural tube defects and other developmental processes.
    *   **OMIM:** Links mutations in CELSR1 to various forms of neural tube defects, including craniorachischisis.
    *   **Comparison:** The articles confirm the role of CELSR1 in cell adhesion, planar cell polarity, and neural tube defects, which aligns with UniProtKB, GeneCards, and OMIM.

*   **MYO18B:**
    *   **UniProtKB:** Encodes an unconventional myosin heavy chain expressed in muscle tissue.
    *   **GeneCards:** MYO18B is involved in muscle function.
    *   **OMIM:** Links mutations in MYO18B to nemaline myopathy.
    *   **Comparison:** The articles confirm the role of MYO18B in muscle function and its association with nemaline myopathy, which aligns with UniProtKB, GeneCards, and OMIM. The articles also link MYO18B to cancer, which is not explicitly mentioned in UniProtKB, GeneCards, or OMIM but is consistent with its role in cell signaling and growth.

*   **TAFA5:**
    *   **UniProtKB:** Encodes a secreted protein belonging to the TAFA family, which are chemokine-like proteins.
    *   **GeneCards:** TAFA5 is involved in immune response and inflammation.
    *   **OMIM:** No direct entry for disease association.
    *   **Comparison:** The articles confirm the role of TAFA5 as a secreted protein and its involvement in immune response and inflammation, which aligns with UniProtKB and GeneCards. The articles also link TAFA5 to cancer and neurological disorders, which is not explicitly mentioned in UniProtKB or GeneCards but is consistent with its role in cell signaling and communication.

*   **PACSIN2:**
    *   **UniProtKB:** Encodes a cytoplasmic adapter protein involved in membrane remodeling and endocytosis.
    *   **GeneCards:** PACSIN2 is involved in synaptic vesicle trafficking and neuronal function.
    *   **OMIM:** No direct entry for disease association.
    *   **Comparison:** The articles confirm the role of PACSIN2 in membrane remodeling and endocytosis, which aligns with UniProtKB and GeneCards. The articles also link PACSIN2 to cancer, diabetic retinopathy, and behavioral flexibility, which is not explicitly mentioned in UniProtKB or GeneCards but is consistent with its role in cell signaling and trafficking.

**Consistencies and Discrepancies:**

*   There is a general consistency between the information extracted from the articles and the information available in comprehensive databases. The articles often provide more specific and recent findings, such as the role of specific mutations in disease pathogenesis and the involvement of specific signaling pathways.
*   The articles often link genes to diseases or processes not explicitly mentioned in UniProtKB, GeneCards, or OMIM. This is likely due to the databases not being fully up-to-date with the latest research findings.
*   Some discrepancies may arise from the different contexts in which the genes are studied. For example, a gene may have a well-established role in neuronal function but a less well-known role in cancer.

**Significance:**

*   The consistencies validate the findings presented in the articles and reinforce the established knowledge about these genes.
*   The discrepancies highlight the importance of text mining of scientific literature to identify novel gene-disease associations and to stay up-to-date with the latest research findings.
*   The identification of novel gene-disease associations and signaling pathways could lead to new therapeutic targets and diagnostic markers.

---